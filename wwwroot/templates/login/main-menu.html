<!DOCTYPE html>
<html data-theme="light" class="h-full">

<head>
    <title>Glavni meni - ASConto</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://cdn.tailwindcss.com/4.1.3"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body class="h-full flex">

    <!-- Sidebar -->
    <div class="w-64 bg-base-200 h-full flex flex-col border-r">
        <!-- Header -->
        <div class="p-4 border-b bg-base-300">
            <h1 class="text-xl font-bold">ASConto</h1>
            <p class="text-sm opacity-70">{{CompanyName}} - {{FiscalYear}}</p>
        </div>

        <!-- User Profile -->
        <div class="p-4 border-b">
            <div class="avatar">
                <div class="w-10 rounded">
                    <img src="https://picsum.photos/200/200" alt="User">
                </div>
            </div>
            <p class="font-medium mt-2">{{UserName}}</p>
            <span class="badge badge-accent text-xs">{{UserRole}}</span>
        </div>

        <!-- <button hx-get="/" class="btn btn-sm btn-outline m-2 w-full" id="button1" onclick="alert('Button 1 clicked!')">
            BUTTON
        </button> -->

        <!-- Search -->
        <div class="p-2">
            <input type="text" placeholder="Search modules..." class="input input-bordered input-sm w-full"
                id="menu-search" />
        </div>

        <!-- Menu List -->
        <ul class="menu p-2 flex-1 overflow-y-auto" id="menu-list">
            {{MenuList}}
            <!-- {{#each menuItems}}
            <li class="menu-title"><span>{{this.title}}</span></li>
            {{#each this.submodules}}
            <li>
                <a href="{{this.path}}" hx-get="{{this.path}}" hx-target="#content-area" hx-swap="innerHTML">
                    <i class="{{../icon}}"></i> {{this.title}}
                </a>
            </li>
            {{/each}}
            {{/each}} -->
        </ul>

        <!-- Footer -->
        <div class="p-2 border-t flex items-center justify-between">
            <a href="/logout" class="btn btn-outline btn-sm">Logout</a>
            <label class="swap swap-rotate">
                <input type="checkbox" id="theme-toggle" onchange="toggleTheme()" />
                <svg class="swap-on fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1,1,8,8,0,0,0,8,8,1,1,0,0,0,1-1V12A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1,8,8,0,0,0-8-8,1,1,0,0,0-1,1,1,1,0,0,0,1,1,6,6,0,0,1,6,6,1,1,0,0,0,1,1Z" />
                </svg>
                <svg class="swap-off fill-current w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,0-1.13A8.11,8.11,0,0,1,12.14,19.73Z" />
                </svg>
            </label>
        </div>
    </div>

    <!-- Content Area -->
    <div id="content-area" class="flex-1 p-6 bg-base-100 overflow-y-auto">
        <div class="text-center text-gray-500 mt-20">
            <i class="fas fa-home text-6xl mb-4"></i>
            <h2 class="text-2xl font-light">Welcome to ERP</h2>
            <p>Select a module from the menu to begin.</p>
        </div>
    </div>


    <script src="/js/chain.js"></script>

    <!-- Script: Theme Toggle -->
    <script>
        const html = document.documentElement;
        const themeToggle = document.getElementById('theme-toggle');

        // Load saved theme or default to 'light'
        function loadTheme() {
            const saved = localStorage.getItem('erp-theme');
            if (saved === 'dark') {
                html.setAttribute('data-theme', 'dark');
                themeToggle.checked = true;
            } else {
                html.setAttribute('data-theme', 'light');
                themeToggle.checked = false;
            }
        }

        // Toggle theme
        function toggleTheme() {
            if (themeToggle.checked) {
                html.setAttribute('data-theme', 'dark');
                localStorage.setItem('erp-theme', 'dark');
            } else {
                html.setAttribute('data-theme', 'light');
                localStorage.setItem('erp-theme', 'light');
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', loadTheme);

        // Optional: Sync across tabs
        window.addEventListener('storage', function (e) {
            if (e.key === 'erp-theme') {
                loadTheme();
            }
        });
    </script>

    <!-- Inactivity Logout -->
    <script>
        const INACTIVITY_TIMEOUT = 15 * 60 * 1000; // 15 minutes
        let timer;

        function resetTimer() {
            clearTimeout(timer);
            timer = setTimeout(() => window.location.href = '/logout', INACTIVITY_TIMEOUT);
        }

        resetTimer();
        document.onmousemove = resetTimer;
        document.onkeypress = resetTimer;
        document.onclick = resetTimer;
        document.onscroll = resetTimer;
        document.onfocus = resetTimer;
    </script>
</body>

</html>