<!DOCTYPE html>
<html data-theme="light" class="h-full">

<head>
    <title>Main Menu - ERP</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://cdn.tailwindcss.com/4.1.3"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
</head>

<body class="h-full flex">

    <!-- Sidebar -->
    <div class="w-64 bg-base-200 h-full flex flex-col border-r">
        <!-- Header -->
        <div class="p-4 border-b bg-base-300">
            <h1 class="text-xl font-bold">ERP System</h1>
            <p class="text-sm opacity-70">{{CompanyName}} ({{FiscalYear}})</p>
        </div>

        <!-- User Profile -->
        <div class="p-4 border-b">
            <div class="avatar">
                <div class="w-10 rounded">
                    <img src="https://picsum.photos/200/200" alt="User">
                </div>
            </div>
            <p class="font-medium mt-2">{{UserName}}</p>
            <span class="badge badge-accent text-xs">{{UserRole}}</span>
        </div>

        <!-- Search -->
        <div class="p-2">
            <input type="text" placeholder="Search modules..." class="input input-bordered input-sm w-full"
                id="menu-search" />
        </div>

        <!-- Menu List -->
        <ul class="menu p-2 flex-1 overflow-y-auto" id="menu-list">
            {{MenuList}}
            <!-- 
                {{#each menuItems}}
                <li class="menu-title"><span>{{this.title}}</span></li>
                {{#each this.submodules}}
                <li>
                    <a href="{{this.path}}" hx-get="{{this.path}}" hx-target="#content-area" hx-swap="innerHTML">
                        <i class="{{../icon}}"></i> {{this.title}}
                    </a>
                </li>
                {{/each}}
                {{/each}}
            -->
        </ul>

        <!-- Footer -->
        <div class="p-2 border-t">
            <a href="/logout" class="btn btn-outline btn-sm w-full">Logout</a>
        </div>
    </div>

    <!-- Content Area -->
    <div id="content-area" class="flex-1 p-6 bg-base-100 overflow-y-auto">
        <div class="text-center text-gray-500 mt-20">
            <i class="fas fa-home text-6xl mb-4"></i>
            <h2 class="text-2xl font-light">Welcome to ERP</h2>
            <p>Select a module from the menu to begin.</p>
        </div>
    </div>

    <!-- Script: Search Filter -->
    <script>
        document.getElementById('menu-search').addEventListener('input', function (e) {
            const filter = e.target.value.toLowerCase();
            document.querySelectorAll('#menu-list > li:not(.menu-title)').forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(filter) ? 'list-item' : 'none';
            });
        });

        // Auto-load first module on startup (optional)
        /*
        setTimeout(() => {
          const firstLink = document.querySelector('#menu-list a');
          if (firstLink) {
            htmx.trigger(firstLink, 'click');
          }
        }, 500);
        */
    </script>

    <!-- Inactivity Logout -->
    <script>
        const INACTIVITY_TIMEOUT = 15 * 60 * 1000;
        let timer;
        function resetTimer() {
            clearTimeout(timer);
            timer = setTimeout(() => window.location.href = '/logout', INACTIVITY_TIMEOUT);
        }
        resetTimer();
        document.onmousemove = resetTimer;
        document.onkeypress = resetTimer;
        document.onclick = resetTimer;
    </script>
</body>

</html>